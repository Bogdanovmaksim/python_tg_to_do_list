import unittest
from datetime import datetime, date, timedelta
import os
from database import Database


class DatabaseTest(unittest.TestCase):
    """–¢–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏: —Å–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ,
    –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
    """

    def setUp(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ç–µ—Å—Ç–æ–º.

        –°–æ–∑–¥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—ä–µ–∫—Ç Database –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
        """
        self.test_db = 'test_todo.db'
        self.db = Database(self.test_db)
        self.user_id = 123456

    def tearDown(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞.

        –£–¥–∞–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–Ω–Ω—É—é –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞.
        """
        if os.path.exists(self.test_db):
            try:
                os.remove(self.test_db)
            except:
                pass

    def test_1_add_and_get_tasks(self):
        """–¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
        - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

        :assert: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º
        :assert: –î–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
        """
        self.db.create_table(self.user_id)

        task_id1 = self.db.add_task(self.user_id, "–ö—É–ø–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã")
        task_id2 = self.db.add_task(
            self.user_id, "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ", "–°–µ–º—å—è", date.today() + timedelta(days=1)
        )

        tasks = self.db.get_tasks(self.user_id)
        self.assertEqual(len(tasks), 2)
        self.assertEqual(tasks[0][2], "–ö—É–ø–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã")
        self.assertEqual(tasks[1][3], "–°–µ–º—å—è")

    def test_2_mark_task_as_done(self):
        """–¢–µ—Å—Ç –æ—Ç–º–µ—Ç–∫–∏ –∑–∞–¥–∞—á–∏ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –§—É–Ω–∫—Ü–∏—é mark_done –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è 'done' –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

        :assert: –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
        :assert: –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ '–≤—ã–ø–æ–ª–Ω–µ–Ω–æ' –≤ –ë–î
        """
        self.db.create_table(self.user_id)
        task_id = self.db.add_task(self.user_id, "–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É")

        result = self.db.mark_done(self.user_id, task_id)
        self.assertTrue(result)

        tasks = self.db.get_tasks(self.user_id)
        self.assertEqual(tasks[0][4], 1)  # done = 1

    def test_3_delete_task(self):
        """–¢–µ—Å—Ç —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –§—É–Ω–∫—Ü–∏—é delete_task –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ ID
        - –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏–∑ –ë–î

        :assert: –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏
        :assert: –ó–∞–¥–∞—á–∞ –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–ø–∏—Å–∫–µ –∑–∞–¥–∞—á
        """
        self.db.create_table(self.user_id)
        task_id = self.db.add_task(self.user_id, "–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É")

        result = self.db.delete_task(self.user_id, task_id)
        self.assertTrue(result)

        tasks = self.db.get_tasks(self.user_id)
        self.assertEqual(len(tasks), 0)

    def test_4_clear_all_tasks(self):
        """–¢–µ—Å—Ç –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –§—É–Ω–∫—Ü–∏—é clear_all_tasks –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
        - –ü–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á

        :assert: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
        :assert: –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—É—Å—Ç—ã–º
        """
        self.db.create_table(self.user_id)

        self.db.add_task(self.user_id, "–ó–∞–¥–∞—á–∞ 1")
        self.db.add_task(self.user_id, "–ó–∞–¥–∞—á–∞ 2")
        self.db.add_task(self.user_id, "–ó–∞–¥–∞—á–∞ 3")

        deleted = self.db.clear_all_tasks(self.user_id)
        self.assertEqual(deleted, 3)

        tasks = self.db.get_tasks(self.user_id)
        self.assertEqual(len(tasks), 0)

    def test_5_invalid_operations(self):
        """–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏
        - –û–±—Ä–∞–±–æ—Ç–∫—É –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

        :assert: –§—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç False –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞—á
        :assert: –û—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0
        """
        self.db.create_table(self.user_id)

        # –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ—Ç–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–¥–∞—á—É
        result = self.db.mark_done(self.user_id, 999)
        self.assertFalse(result)

        # –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–¥–∞—á—É
        result = self.db.delete_task(self.user_id, 999)
        self.assertFalse(result)

        # –û—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞
        deleted = self.db.clear_all_tasks(self.user_id)
        self.assertEqual(deleted, 0)


class DateValidationTest(unittest.TestCase):
    """–¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º –±–æ—Ç–æ–º.

    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º:
    - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç YYYY-MM-DD
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥–∞—Ç—ã –≤ –ø—Ä–æ—à–ª–æ–º
    - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É (10 –ª–µ—Ç –≤–ø–µ—Ä–µ–¥)
    """

    def test_1_valid_future_date(self):
        """–¢–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –±—É–¥—É—â–µ–π –¥–∞—Ç—ã.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –¥–∞—Ç—ã –≤ –±—É–¥—É—â–µ–º –ø—Ä–æ—Ö–æ–¥—è—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é.

        :assert: –ë—É–¥—É—â–∞—è –¥–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è
        :assert: –î–∞—Ç–∞ –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–π
        """
        future_date = (date.today() + timedelta(days=5)).strftime('%Y-%m-%d')
        deadline = datetime.strptime(future_date, '%Y-%m-%d').date()
        self.assertGreater(deadline, date.today())

    def test_2_date_in_past(self):
        """–¢–µ—Å—Ç –¥–∞—Ç—ã –≤ –ø—Ä–æ—à–ª–æ–º.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø—Ä–æ—à–ª–∏.

        :assert: –î–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è
        :assert: –î–∞—Ç–∞ –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–π (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—à–µ–¥—à–∞—è)
        """
        past_date = (date.today() - timedelta(days=1)).strftime('%Y-%m-%d')
        deadline = datetime.strptime(past_date, '%Y-%m-%d').date()
        self.assertLess(deadline, date.today())

    def test_3_invalid_date_format(self):
        """–¢–µ—Å—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç.

        :assert: ValueError –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
        :raises ValueError: –ö–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç YYYY-MM-DD
        """
        with self.assertRaises(ValueError):
            datetime.strptime("2024/12/25", '%Y-%m-%d')

    def test_4_boundary_date_10_years(self):
        """–¢–µ—Å—Ç –≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–ª—É—á–∞—è - —Ä–æ–≤–Ω–æ 10 –ª–µ—Ç –≤–ø–µ—Ä–µ–¥.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞—Ç—ã, –∫–æ—Ç–æ—Ä–∞—è —Ä–æ–≤–Ω–æ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞.

        :assert: –î–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è
        :assert: –î–∞—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–π (—Ä–æ–≤–Ω–æ 10 –ª–µ—Ç –≤–ø–µ—Ä–µ–¥)
        """
        today = date.today()
        ten_years_later = date(today.year + 10, today.month, today.day)

        ten_years_str = ten_years_later.strftime('%Y-%m-%d')
        deadline = datetime.strptime(ten_years_str, '%Y-%m-%d').date()

        self.assertEqual(deadline, ten_years_later)

    def test_5_too_far_date(self):
        """–¢–µ—Å—Ç –¥–∞—Ç—ã —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –≤ –±—É–¥—É—â–µ–º.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞—Ç, –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç (10 –ª–µ—Ç).

        :assert: –î–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –ø–∞—Ä—Å–∏—Ç—Å—è
        :assert: –î–∞—Ç–∞ –±–æ–ª—å—à–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–π
        """
        today = date.today()
        too_far = date(today.year + 11, today.month, today.day)
        too_far_str = too_far.strftime('%Y-%m-%d')

        deadline = datetime.strptime(too_far_str, '%Y-%m-%d').date()
        max_allowed = date(today.year + 10, today.month, today.day)

        self.assertGreater(deadline, max_allowed)


class StatisticsTest(unittest.TestCase):
    """–¢–µ—Å—Ç—ã –ª–æ–≥–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞.

    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –∏
    –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞.
    """

    def test_1_empty_task_list(self):
        """–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–ª—É—á–∞—è - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–¥–∞—á.

        :assert: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á —Ä–∞–≤–Ω–æ 0
        :assert: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Ä–∞–≤–Ω–æ 0
        :assert: –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–≤–µ–Ω 0
        """
        tasks = []
        total = len(tasks)
        done = sum(1 for task in tasks if task[4]) if tasks else 0
        percent = (done / total * 100) if total > 0 else 0

        self.assertEqual(total, 0)
        self.assertEqual(done, 0)
        self.assertEqual(percent, 0)

    def test_2_all_tasks_done(self):
        """–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –∫–æ–≥–¥–∞ –≤—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å—á–µ—Ç –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è - 100% –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

        :assert: –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–≤–µ–Ω 100%
        :assert: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–≤–Ω–æ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
        """
        mock_tasks = [
            (1, 123, "–ó–∞–¥–∞—á–∞ 1", "–ö–∞—Ç–µ–≥–æ—Ä–∏—è", 1, "2024-12-25"),
            (2, 123, "–ó–∞–¥–∞—á–∞ 2", None, 1, None),
            (3, 123, "–ó–∞–¥–∞—á–∞ 3", "–†–∞–±–æ—Ç–∞", 1, "2024-12-26"),
        ]

        total = len(mock_tasks)
        done = sum(1 for task in mock_tasks if task[4])
        percent = (done / total * 100)

        self.assertEqual(total, 3)
        self.assertEqual(done, 3)
        self.assertEqual(percent, 100.0)

    def test_3_mixed_completion(self):
        """–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è.

        :assert: –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
        :assert: –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
        """
        mock_tasks = [
            (1, 123, "–ó–∞–¥–∞—á–∞ 1", "–ö–∞—Ç1", 1, "2024-12-25"),
            (2, 123, "–ó–∞–¥–∞—á–∞ 2", "–ö–∞—Ç2", 0, None),
            (3, 123, "–ó–∞–¥–∞—á–∞ 3", None, 1, "2024-12-26"),
            (4, 123, "–ó–∞–¥–∞—á–∞ 4", "–ö–∞—Ç3", 0, "2024-12-27"),
            (5, 123, "–ó–∞–¥–∞—á–∞ 5", None, 1, None),
        ]

        total = len(mock_tasks)
        done = sum(1 for task in mock_tasks if task[4])
        percent = (done / total * 100)

        self.assertEqual(total, 5)
        self.assertEqual(done, 3)
        self.assertAlmostEqual(percent, 60.0)

    def test_4_progress_bar_generation(self):
        """–¢–µ—Å—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
        - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
        - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–ª–∏–Ω—É –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
        - –í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

        :assert: –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞
        """
        test_cases = [
            (0, "‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú"),    # 0%
            (50, "üü®üü®üü®üü®üü®‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú"),  # 50%
            (80, "üü©üü©üü©üü©üü©üü©üü©üü©‚¨ú‚¨ú"),  # 80%
            (100, "üü©üü©üü©üü©üü©üü©üü©üü©üü©üü©"),  # 100%
        ]

        for percent, expected in test_cases:
            bar_length = 10
            filled = int(bar_length * percent / 100)

            # –õ–æ–≥–∏–∫–∞ –∏–∑ –±–æ—Ç–∞
            if percent >= 80:
                filled_char = "üü©"
            elif percent >= 50:
                filled_char = "üü®"
            else:
                filled_char = "üü•"

            progress_bar = filled_char * filled + "‚¨ú" * (bar_length - filled)
            self.assertEqual(progress_bar, expected)

    def test_5_single_task(self):
        """–¢–µ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏.

        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —Å–ª—É—á–∞—è - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞.

        :assert: –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –¥–ª—è –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏
        :assert: –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–æ
        """
        mock_tasks = [(1, 123, "–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞", None, 1, None)]

        total = len(mock_tasks)
        done = sum(1 for task in mock_tasks if task[4])
        percent = (done / total * 100)

        self.assertEqual(total, 1)
        self.assertEqual(done, 1)
        self.assertEqual(percent, 100.0)


if __name__ == "__main__":
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤.

    –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –∫–ª–∞—Å—Å–∞—Ö –≤—ã—à–µ.
    –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤.
    """
    unittest.main()